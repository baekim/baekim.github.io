{"componentChunkName":"component---src-templates-post-template-tsx","path":"/네이버_영화_페이지_크롤링/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2a822c9f08b8b04d5922ffd06c91e53f/b5600/python_mongo.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 51.5625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABcRAAAXEQHKJvM/AAABLklEQVQoz42S3UoCURSFTxNSoXThT2TqmKLUpDOOozOoZDJkImUgKmGDV3XhA9R9j1Nv+YXHSSxM52JxNpt1FnvttcWelWUdoqrurLf2NhFERUXoKkpt2Vd8/HBWvF2CsqFnOO4XSEwuEFoSYZwhdB+VNCE7z34996/ob8FaFqGlybxeYX7YaI9dqtM+de+B8rhLeXLH+H3O6G3OYaOIMDMBJjRVQo0c4ZsckaZG3LU47da4HLpEOwZx1+Tk1pKTBtih/xpJIm6P0mxGtJ0n3NJI9xyKgzaxjsGBU5D2d1teLH9hu5Sk+TLh8+sZ+6mF4w2pT+8lHG9AwjVXggFSVhFmliMnRew6hagsE5bp6n5I/u6CpSxtL0UXYrL2T0Wxzrfe4EbBdbIS4JD//v0Gi3QUbHvjgxYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/2a822c9f08b8b04d5922ffd06c91e53f/a59e9/python_mongo.webp 192w,\n/static/2a822c9f08b8b04d5922ffd06c91e53f/0ca9f/python_mongo.webp 384w,\n/static/2a822c9f08b8b04d5922ffd06c91e53f/dc9b9/python_mongo.webp 768w,\n/static/2a822c9f08b8b04d5922ffd06c91e53f/e2c2f/python_mongo.webp 1152w,\n/static/2a822c9f08b8b04d5922ffd06c91e53f/f3efb/python_mongo.webp 1536w,\n/static/2a822c9f08b8b04d5922ffd06c91e53f/a0063/python_mongo.webp 1602w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/2a822c9f08b8b04d5922ffd06c91e53f/3b721/python_mongo.png 192w,\n/static/2a822c9f08b8b04d5922ffd06c91e53f/66595/python_mongo.png 384w,\n/static/2a822c9f08b8b04d5922ffd06c91e53f/fe486/python_mongo.png 768w,\n/static/2a822c9f08b8b04d5922ffd06c91e53f/d2d74/python_mongo.png 1152w,\n/static/2a822c9f08b8b04d5922ffd06c91e53f/e8464/python_mongo.png 1536w,\n/static/2a822c9f08b8b04d5922ffd06c91e53f/b5600/python_mongo.png 1602w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/2a822c9f08b8b04d5922ffd06c91e53f/fe486/python_mongo.png\"\n            alt=\"image.info\"\n            title=\"image.info\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h2>네이버 영화 랭킹, 제목, 평점 가져오기</h2>\n<p>네이버 영화 페이지에서 크롤링을 통해 데이터를 제어하고자 한다. <a href=\"https://movie.naver.com/movie/sdb/rank/rmovie.naver?sel=pnt&#x26;date=20210723\" target=\"_blank\" rel=\"nofollow\">네이버 영화 바로가기</a></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/16721f65ca6e2032903fa31ae1f81159/9afce/%EB%84%A4%EC%9D%B4%EB%B2%84_%EC%98%81%ED%99%94_%ED%8E%98%EC%9D%B4%EC%A7%80_%ED%81%AC%EB%A1%A4%EB%A7%81_1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 57.29166666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA6cAAAOnAEHlFPdAAACPUlEQVQoz51RQWsTQRjdf2OTVdCWpCRFxNY0hdhLTx7aoxf/g7dWsCA9eqw0IPkBXoTatGkDQi2IgidpqWkkbZLd7M7uzu7sfN+TGcFW8OTAY77hffPmfW+c8oN7uvqwrOcqVf1yc1O/bbX0zs6Objabdv8XDNdqtfT29hu99WpLb6yv6/UXG/r5+9faqTeWsVBfQqlaRXtvD5RJ/PfSgPNubZX311a5tVTnj50OA8xBELCUkvM8tyAiC1NnWcZpmtpdKcVZpv7UcRKz82xlBU+Xl/FkYQHdTgeZUsiyDMxsYWohBCIhQET2nCQJlOlLJXzft7XWOeI4hrPYaOD+/DxKlQo6BwcIggDj8Rie5+Hq6gqnZ2f4dHyMk5MTTMIQiZSWC0WExBvCHw2hiexjVvBxo4F6vY7y7CyODg9tFCrPf0ei9XU+TOBEIE8i69Jwk8kEF/2+dWxWFEVwHtVqaCzWUJ6ZQbf9ARj14YUCSmX2ojLjG71EgL9/Bg3OrUMjmKapjcOMbGAFp6enMVcq4e7tOzja2wXGP+EFAqmUfwvKCHz6FfqyZ3MzgoY34lJKa8AKFgoFvjU1xVNFl7vtXcbwgsdBaDVugpOI+fQL68sf7Ps+ayLOgjGPBgOWaWp74jhmx3VdGBRcF13jcHQBX0TI0tQGbX/7xsh6cA7f8y1nPrDX6yEMw+sMXdcl1y1SoVikw/02IQlpEoYURRHleW4UiQFiGRGdfyM97JMIQ9Jak5SShBC2TylFcRzTL4sC9rtraChFAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/16721f65ca6e2032903fa31ae1f81159/a59e9/%EB%84%A4%EC%9D%B4%EB%B2%84_%EC%98%81%ED%99%94_%ED%8E%98%EC%9D%B4%EC%A7%80_%ED%81%AC%EB%A1%A4%EB%A7%81_1.webp 192w,\n/static/16721f65ca6e2032903fa31ae1f81159/0ca9f/%EB%84%A4%EC%9D%B4%EB%B2%84_%EC%98%81%ED%99%94_%ED%8E%98%EC%9D%B4%EC%A7%80_%ED%81%AC%EB%A1%A4%EB%A7%81_1.webp 384w,\n/static/16721f65ca6e2032903fa31ae1f81159/dc9b9/%EB%84%A4%EC%9D%B4%EB%B2%84_%EC%98%81%ED%99%94_%ED%8E%98%EC%9D%B4%EC%A7%80_%ED%81%AC%EB%A1%A4%EB%A7%81_1.webp 768w,\n/static/16721f65ca6e2032903fa31ae1f81159/2c45b/%EB%84%A4%EC%9D%B4%EB%B2%84_%EC%98%81%ED%99%94_%ED%8E%98%EC%9D%B4%EC%A7%80_%ED%81%AC%EB%A1%A4%EB%A7%81_1.webp 1001w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/16721f65ca6e2032903fa31ae1f81159/3b721/%EB%84%A4%EC%9D%B4%EB%B2%84_%EC%98%81%ED%99%94_%ED%8E%98%EC%9D%B4%EC%A7%80_%ED%81%AC%EB%A1%A4%EB%A7%81_1.png 192w,\n/static/16721f65ca6e2032903fa31ae1f81159/66595/%EB%84%A4%EC%9D%B4%EB%B2%84_%EC%98%81%ED%99%94_%ED%8E%98%EC%9D%B4%EC%A7%80_%ED%81%AC%EB%A1%A4%EB%A7%81_1.png 384w,\n/static/16721f65ca6e2032903fa31ae1f81159/fe486/%EB%84%A4%EC%9D%B4%EB%B2%84_%EC%98%81%ED%99%94_%ED%8E%98%EC%9D%B4%EC%A7%80_%ED%81%AC%EB%A1%A4%EB%A7%81_1.png 768w,\n/static/16721f65ca6e2032903fa31ae1f81159/9afce/%EB%84%A4%EC%9D%B4%EB%B2%84_%EC%98%81%ED%99%94_%ED%8E%98%EC%9D%B4%EC%A7%80_%ED%81%AC%EB%A1%A4%EB%A7%81_1.png 1001w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/16721f65ca6e2032903fa31ae1f81159/fe486/%EB%84%A4%EC%9D%B4%EB%B2%84_%EC%98%81%ED%99%94_%ED%8E%98%EC%9D%B4%EC%A7%80_%ED%81%AC%EB%A1%A4%EB%A7%81_1.png\"\n            alt=\"image.info\"\n            title=\"image.info\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span><br/></p>\n<p>🔽 파이썬에 requests, BeautifulSoup, pymongo 패키지를 설치한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 478px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f6edd6e3b0c0418fb93497b1b88dcd6b/e4b77/%EB%84%A4%EC%9D%B4%EB%B2%84_%EC%98%81%ED%99%94_%ED%8E%98%EC%9D%B4%EC%A7%80_%ED%81%AC%EB%A1%A4%EB%A7%81_2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.14583333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA6cAAAOnAEHlFPdAAAC2ElEQVQ4y1WSS28URxSF+weFKAOMX3F3V3e9uqpf9Nix4/g1xuIRsIxxglCiKCTGMWAk46BgRUEIKQvEgn3C1n/DS2+8IauJ1HKP74m6bQZS0qdTdUs60j33Oq/evCm/Xl0rv737fbmytl7eWL094GbNrQ+srH1TLl+7WT5/8bIEMICIBuo8eLyD1iiDp1IMuRzt8QDDnsAYUxhyQwyNBwNGPI5PLozg9p3vUFUVer0ejo+PcXJyMsDZ3XtJ4eQ6RTN3KLQpRUaTijSFQhLjkvyQEwsFMS4Gb2VimpqZJZvm9NffbwnAAGdn9ykFyiLJCxK2gEimEEQd+CoG4xxCR+BKww95A+MCXhBi3GdoXWzj2d4ejo6OcHBwgMPDQzhPfn1KXEVIspRksQw7exd6eh1e8hVEnEIlBZiK4QnT4J6pL20D0zHCKG3q85evfjDMO5MUWYssz6C0gh9wCJMh1BYe13BDBSYNpM0QKANfaPgiav7q+5jPMbOwBGfnyS65LIRNMtI2RZwXiLMCMrIwSQqbZvBDAZcFjcZ53tSjJDmNQ2uIKGqimF/swnm4/ZjOtS5gzPVJaIP0UgfaJgiEqnOFSTN4YZ2bQCA18s4ElDEQkYE0tkHZGIHSmO8uwfn9j+c0MfUl5ha69dSQFROojX0uG3NlE7iMww14Y5gUX8DkHcg4gzQxpDGnhlKdGpZlSb3ev3j37h+aW+jic4+hjqBuMclSmNhAKgku6imHkPkMVDHXIOL8rGUDJuSp4fv96ff7tLG5RddvrNDK6i2anuuSnVymbPoKRcUihcksBWaCpI5IqHpPBQVCUsAlhUKRywKaX1wih4jwnvrU216fF3++xqfeFFh2BaN6EX56Fa6eRntkFK32MFoXhwacbw/j3Gfncakzidqw+ph+v18BqPb396t7936otrcfVFtb9xt99OhhtbH5S/Xz/c3/Udd+/Gmj+u3ZXvUfsr1GFVE9VM8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/f6edd6e3b0c0418fb93497b1b88dcd6b/a59e9/%EB%84%A4%EC%9D%B4%EB%B2%84_%EC%98%81%ED%99%94_%ED%8E%98%EC%9D%B4%EC%A7%80_%ED%81%AC%EB%A1%A4%EB%A7%81_2.webp 192w,\n/static/f6edd6e3b0c0418fb93497b1b88dcd6b/0ca9f/%EB%84%A4%EC%9D%B4%EB%B2%84_%EC%98%81%ED%99%94_%ED%8E%98%EC%9D%B4%EC%A7%80_%ED%81%AC%EB%A1%A4%EB%A7%81_2.webp 384w,\n/static/f6edd6e3b0c0418fb93497b1b88dcd6b/3c317/%EB%84%A4%EC%9D%B4%EB%B2%84_%EC%98%81%ED%99%94_%ED%8E%98%EC%9D%B4%EC%A7%80_%ED%81%AC%EB%A1%A4%EB%A7%81_2.webp 478w\"\n              sizes=\"(max-width: 478px) 100vw, 478px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/f6edd6e3b0c0418fb93497b1b88dcd6b/3b721/%EB%84%A4%EC%9D%B4%EB%B2%84_%EC%98%81%ED%99%94_%ED%8E%98%EC%9D%B4%EC%A7%80_%ED%81%AC%EB%A1%A4%EB%A7%81_2.png 192w,\n/static/f6edd6e3b0c0418fb93497b1b88dcd6b/66595/%EB%84%A4%EC%9D%B4%EB%B2%84_%EC%98%81%ED%99%94_%ED%8E%98%EC%9D%B4%EC%A7%80_%ED%81%AC%EB%A1%A4%EB%A7%81_2.png 384w,\n/static/f6edd6e3b0c0418fb93497b1b88dcd6b/e4b77/%EB%84%A4%EC%9D%B4%EB%B2%84_%EC%98%81%ED%99%94_%ED%8E%98%EC%9D%B4%EC%A7%80_%ED%81%AC%EB%A1%A4%EB%A7%81_2.png 478w\"\n            sizes=\"(max-width: 478px) 100vw, 478px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/f6edd6e3b0c0418fb93497b1b88dcd6b/e4b77/%EB%84%A4%EC%9D%B4%EB%B2%84_%EC%98%81%ED%99%94_%ED%8E%98%EC%9D%B4%EC%A7%80_%ED%81%AC%EB%A1%A4%EB%A7%81_2.png\"\n            alt=\"image.info\"\n            title=\"image.info\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span><br/></p>\n<p>🔽 위 패키지들을 import 시키고, mongoDB client를 불러준다. database name은 ‘testdb’로 정했다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># crawling_movie_list.py</span>\r\n<span class=\"token keyword\">import</span> requests\r\n<span class=\"token keyword\">from</span> bs4 <span class=\"token keyword\">import</span> BeautifulSoup\r\n<span class=\"token keyword\">from</span> pymongo <span class=\"token keyword\">import</span> MongoClient\r\n\r\nclient <span class=\"token operator\">=</span> MongoClient<span class=\"token punctuation\">(</span><span class=\"token string\">'localhost'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">27017</span><span class=\"token punctuation\">)</span>\r\ndb <span class=\"token operator\">=</span> client<span class=\"token punctuation\">.</span>testdb</code></pre></div>\n<p>🔽 크롤링을 위해 기본 브라우저 속성을 잡아주고, 데이터를 받아온다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">headers <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'User-Agent'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'Mozilla/5.0 (Windows NT 10.0; Win64; x64)AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.86 Safari/537.36'</span><span class=\"token punctuation\">}</span>\r\ndata <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'https://movie.naver.com/movie/sdb/rank/rmovie.nhn?sel=pnt&amp;date=20210723'</span><span class=\"token punctuation\">,</span> headers<span class=\"token operator\">=</span>headers<span class=\"token punctuation\">)</span></code></pre></div>\n<p>🔽 위에서 본 네이버 영화 페이지의 전체 <html> 를 모두 가져온다</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">soup <span class=\"token operator\">=</span> BeautifulSoup<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">,</span> <span class=\"token string\">'html.parser'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>🔽 이제 우리가 필요한 영화 제목들을 가져와보자.</p>\n<p>크롤링한 source 코드를 보고 가져올 부분 근처를 보고, 가장 가까운 부모 id값을 찾아 #태그로 불러준다.</p>\n<p>Chrome Browser를 이용하면 해당 부분에서 우클릭으로 copy > copy selector 기능을 통해 가져올 수 있다.</p>\n<p>각 영화 정보는 &#x3C;tr 태그> 안에 담겨져 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">tr_tags <span class=\"token operator\">=</span> soup<span class=\"token punctuation\">.</span>select<span class=\"token punctuation\">(</span><span class=\"token string\">'#old_content > table > tbody > tr'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>🔽 이제 영화 제목이 담긴 &#x3C;a 태그> 부분을 가져온다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">for</span> tr <span class=\"token keyword\">in</span> tr_tags<span class=\"token punctuation\">:</span>\r\n    a_tag <span class=\"token operator\">=</span> tr<span class=\"token punctuation\">.</span>select_one<span class=\"token punctuation\">(</span><span class=\"token string\">'td.title > div > a'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>🔽 네이버 영화 페이지에는 10개 영화마다 구분선이 존재하는데, 구분선도 &#x3C;tr 태그> 안에 담겨 있기 때문에, for loop를 돌려 하위 값을 불러오고자하면 오류가 발생한다. 따라서 구분선 제외하는 작업이 필요하다.</p>\n<p>구분선을 제외하고, 영화 제목을 출력해보면 아래와 같이 50개의 영화 제목이 출력된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">if</span> a_tag <span class=\"token keyword\">is</span> <span class=\"token keyword\">not</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">:</span>\r\n    title <span class=\"token operator\">=</span> a_tag<span class=\"token punctuation\">.</span>text\r\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>title<span class=\"token punctuation\">)</span>\r\n    \r\n<span class=\"token operator\">>></span> 그린 북\r\n가버나움\r\n디지몬 어드벤처 라스트 에볼루션 <span class=\"token punctuation\">:</span> 인연\r\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\r\n쉰들러 리스트\r\n클레멘타인\r\n여인의 향기</code></pre></div>\n<p>🔽 제목이 잘 들어오는 것을 확인했다면, 이제 순위, 제목, 평점을 가져와보자.</p>\n<p>순위는 &#x3C;img 태그> 안의 alt 속성안에 들어있고,\r\n평점은 &#x3C;td 태그> 중 class=“point” 인 태그안에 들어있다.</p>\n<p>결과를 확인하면 아래와 같이 rank, title, stars 순으로 출력해준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">if</span> a_tag <span class=\"token keyword\">is</span> <span class=\"token keyword\">not</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">:</span>\r\n    rank <span class=\"token operator\">=</span> tr<span class=\"token punctuation\">.</span>select_one<span class=\"token punctuation\">(</span><span class=\"token string\">'td:nth-child(1) > img'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token string\">'alt'</span><span class=\"token punctuation\">]</span>\r\n    title <span class=\"token operator\">=</span> a_tag<span class=\"token punctuation\">.</span>text\r\n    stars <span class=\"token operator\">=</span> tr<span class=\"token punctuation\">.</span>select_one<span class=\"token punctuation\">(</span><span class=\"token string\">'td.point'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>text\r\n\r\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>rank<span class=\"token punctuation\">,</span> title<span class=\"token punctuation\">,</span> stars<span class=\"token punctuation\">)</span>\r\n\r\n<span class=\"token operator\">>></span> <span class=\"token number\">01</span> 그린 북 <span class=\"token number\">9.60</span>\r\n<span class=\"token number\">02</span> 가버나움 <span class=\"token number\">9.59</span>\r\n<span class=\"token number\">03</span> 디지몬 어드벤처 라스트 에볼루션 <span class=\"token punctuation\">:</span> 인연 <span class=\"token number\">9.54</span>\r\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\r\n<span class=\"token number\">48</span> 쉰들러 리스트 <span class=\"token number\">9.37</span>\r\n<span class=\"token number\">49</span> 클레멘타인 <span class=\"token number\">9.37</span>\r\n<span class=\"token number\">50</span> 여인의 향기 <span class=\"token number\">9.37</span></code></pre></div>\n<p>🔽 이제 mongoDB에 넣어보자. 앞서 mongoDB에 testdb라는 collection을 만들어 두었다. 이제 아래 코드를 통해 movies라는 테이블을 만들고, 그 안에 영화 목록을 넣어보자.</p>\n<p>영화 순위, 제목, 평점을 딕셔너리로 묶어주고 insert_one()을 통해 movies 테이블 안으로 인서트 해준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">if</span> a_tag <span class=\"token keyword\">is</span> <span class=\"token keyword\">not</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">:</span>\r\n    rank <span class=\"token operator\">=</span> tr<span class=\"token punctuation\">.</span>select_one<span class=\"token punctuation\">(</span><span class=\"token string\">'td:nth-child(1) > img'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token string\">'alt'</span><span class=\"token punctuation\">]</span>\r\n    title <span class=\"token operator\">=</span> a_tag<span class=\"token punctuation\">.</span>text\r\n    stars <span class=\"token operator\">=</span> tr<span class=\"token punctuation\">.</span>select_one<span class=\"token punctuation\">(</span><span class=\"token string\">'td.point'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>text\r\n\r\n    <span class=\"token comment\"># print(rank, title, stars)</span>\r\n    item <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token string\">'rank'</span><span class=\"token punctuation\">:</span> rank<span class=\"token punctuation\">,</span>\r\n        <span class=\"token string\">'title'</span><span class=\"token punctuation\">:</span> title<span class=\"token punctuation\">,</span>\r\n        <span class=\"token string\">'stars'</span><span class=\"token punctuation\">:</span> stars\r\n    <span class=\"token punctuation\">}</span>\r\n    db<span class=\"token punctuation\">.</span>movies<span class=\"token punctuation\">.</span>insert_one<span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">)</span></code></pre></div>\n<p>🔽 MongoDB를 확인해보면 아래와 같이 들어오는 것을 볼 수 있다.</p>\n<p>MongoDB를 확인하기 위해 ‘Robo 3T’라는 open-source MongoDB GUI를 사용했다. <a href=\"https://robomongo.org/\" target=\"_blank\" rel=\"nofollow\">Robo 3T 바로가기</a></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 426px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/05e3d1c1503ff0214b3055f2f66e35f3/28e10/%EB%84%A4%EC%9D%B4%EB%B2%84_%EC%98%81%ED%99%94_%ED%8E%98%EC%9D%B4%EC%A7%80_%ED%81%AC%EB%A1%A4%EB%A7%81_3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 121.35416666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAYCAYAAAD6S912AAAACXBIWXMAAA6cAAAOnAEHlFPdAAADLklEQVQ4y42Vb2/TMBDG++mREG+AbmXdYB+FjSFgEppo935so3H+Nm3sJI3TpXfoucRpOkAi0iPHjvfrc747b1RWhU2z1GbrzBpjrNbaZlrb7XZr67qW8X/VNI0d+b7PFxeX/OnqM3/9ds0fP17w1ecr/nZ9zZeXn/jm5obnt7c8m815Nt9rPr9tdduOP2YzXiYJj37M5jQ5mdLZh3M6mZ7S9GxKp+cndHI6oQ/n5/T+bEpHxxM6mryj8dExjY8nojfjY3o7PqLXb8fy7cXLV/Tl+juNbL3l5TLlylrOTc5lWfLwqaqKn56euLZ1t0JMxGy3DTdNw7W1bEzBGVRseFTXNefGcLpMOU1TXi6XojhOOE1XnGWaN5uNrK3XmSB3ux0TkQjPer3ioizkfWSrio0xrDzF3sLjxWLBnufxr18LDoJAvgG4SlN+fHxkGAAQruEQMkbLDwuw6oC+UgKClGrhYRiyNobLTcmr1YqRQKwhEuzDO0BGa9n3zKEnEGzEH2IMghYIh0mS8Hq97h06IWwAjQNWw5A91QEVLxYeR2HUA3GGP3/eCVhS052hAM0AaCVLh0DVhY8zHDrE+W632w60Twwc5nm+B2IS+L6ECgHkK5+jKGZjcimdOI57F0jEEIgq6YH4dUzCIBQQhMP2/UAgziHOD/Msy/oaHQL7kLFZay2OJGyl+qTAIb4VRSHAh4cHvr+/l+9Yd1DA3HzkfsXV1FAuizgWmTdN2zV1LfOhS7dXHMJBEsUSEoQExFEs3YNvAMIh1iEAhx2DPZA4xAvsBghZqV6oSZcIJCWKIo7CUBzuM01/hnwA9AZAr6tDrQXoyqbtjsOelk7ZA3PWWcZK+riV8vet53oZdx3mh+H+C6g1q8WgsLtOCcOoByJ8jM9vG9cpfR3i/muB3mGnoPWiPdBda5j/ARx2StmdIepQalG1nYJxmBTAUIdJHP/FITqly3Ke56S1psAPRL4fUBiGMiZxQsYYqqqKkiShu7s7KsuS2vLbP7kxVBSFrLdZzrLeneo6BSNC1trIv4W0u2ARmmsEd4W111e7jk5pdrtd868H35yezw/U7BqwfgMZdRRm4i9lZwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/05e3d1c1503ff0214b3055f2f66e35f3/a59e9/%EB%84%A4%EC%9D%B4%EB%B2%84_%EC%98%81%ED%99%94_%ED%8E%98%EC%9D%B4%EC%A7%80_%ED%81%AC%EB%A1%A4%EB%A7%81_3.webp 192w,\n/static/05e3d1c1503ff0214b3055f2f66e35f3/0ca9f/%EB%84%A4%EC%9D%B4%EB%B2%84_%EC%98%81%ED%99%94_%ED%8E%98%EC%9D%B4%EC%A7%80_%ED%81%AC%EB%A1%A4%EB%A7%81_3.webp 384w,\n/static/05e3d1c1503ff0214b3055f2f66e35f3/039b3/%EB%84%A4%EC%9D%B4%EB%B2%84_%EC%98%81%ED%99%94_%ED%8E%98%EC%9D%B4%EC%A7%80_%ED%81%AC%EB%A1%A4%EB%A7%81_3.webp 426w\"\n              sizes=\"(max-width: 426px) 100vw, 426px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/05e3d1c1503ff0214b3055f2f66e35f3/3b721/%EB%84%A4%EC%9D%B4%EB%B2%84_%EC%98%81%ED%99%94_%ED%8E%98%EC%9D%B4%EC%A7%80_%ED%81%AC%EB%A1%A4%EB%A7%81_3.png 192w,\n/static/05e3d1c1503ff0214b3055f2f66e35f3/66595/%EB%84%A4%EC%9D%B4%EB%B2%84_%EC%98%81%ED%99%94_%ED%8E%98%EC%9D%B4%EC%A7%80_%ED%81%AC%EB%A1%A4%EB%A7%81_3.png 384w,\n/static/05e3d1c1503ff0214b3055f2f66e35f3/28e10/%EB%84%A4%EC%9D%B4%EB%B2%84_%EC%98%81%ED%99%94_%ED%8E%98%EC%9D%B4%EC%A7%80_%ED%81%AC%EB%A1%A4%EB%A7%81_3.png 426w\"\n            sizes=\"(max-width: 426px) 100vw, 426px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/05e3d1c1503ff0214b3055f2f66e35f3/28e10/%EB%84%A4%EC%9D%B4%EB%B2%84_%EC%98%81%ED%99%94_%ED%8E%98%EC%9D%B4%EC%A7%80_%ED%81%AC%EB%A1%A4%EB%A7%81_3.png\"\n            alt=\"image.info\"\n            title=\"image.info\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span><br/></p>\n<p>🔽 전체 코드를 보면 다음과 같다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> requests\r\n<span class=\"token keyword\">from</span> bs4 <span class=\"token keyword\">import</span> BeautifulSoup\r\n<span class=\"token keyword\">from</span> pymongo <span class=\"token keyword\">import</span> MongoClient\r\n\r\nclient <span class=\"token operator\">=</span> MongoClient<span class=\"token punctuation\">(</span><span class=\"token string\">'localhost'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">27017</span><span class=\"token punctuation\">)</span>\r\ndb <span class=\"token operator\">=</span> client<span class=\"token punctuation\">.</span>testdb\r\n\r\nheaders <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'User-Agent'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'Mozilla/5.0 (Windows NT 10.0; Win64; x64)AppleWebKit/537.36 (KHTML, like Gecko) '</span>\r\n                         <span class=\"token string\">'Chrome/73.0.3683.86 Safari/537.36'</span><span class=\"token punctuation\">}</span>\r\ndata <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'https://movie.naver.com/movie/sdb/rank/rmovie.nhn?sel=pnt&amp;date=20210723'</span><span class=\"token punctuation\">,</span> headers<span class=\"token operator\">=</span>headers<span class=\"token punctuation\">)</span>\r\n\r\n<span class=\"token comment\"># 해당 페이지의 Elements 를 모두 가져오자</span>\r\nsoup <span class=\"token operator\">=</span> BeautifulSoup<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">,</span> <span class=\"token string\">'html.parser'</span><span class=\"token punctuation\">)</span>\r\n\r\n<span class=\"token comment\"># 영화 제목들 가져오기 (.select)</span>\r\ntr_tags <span class=\"token operator\">=</span> soup<span class=\"token punctuation\">.</span>select<span class=\"token punctuation\">(</span><span class=\"token string\">'#old_content > table > tbody > tr'</span><span class=\"token punctuation\">)</span>\r\n\r\n<span class=\"token keyword\">for</span> tr <span class=\"token keyword\">in</span> tr_tags<span class=\"token punctuation\">:</span>\r\n    <span class=\"token comment\"># 책 제목이 담긴 &lt;a 태그> 부분을 가져오자</span>\r\n    a_tag <span class=\"token operator\">=</span> tr<span class=\"token punctuation\">.</span>select_one<span class=\"token punctuation\">(</span><span class=\"token string\">'td.title > div > a'</span><span class=\"token punctuation\">)</span>\r\n\r\n    <span class=\"token comment\"># week3-3 부분들이 None 처리되어 들어온다</span>\r\n    <span class=\"token comment\"># None 부분들을 필터하고 제목들 가져오자</span>\r\n    <span class=\"token keyword\">if</span> a_tag <span class=\"token keyword\">is</span> <span class=\"token keyword\">not</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">:</span>\r\n\r\n        <span class=\"token comment\"># rank, title, evaluation 확인하기</span>\r\n        <span class=\"token comment\"># rank 값이 들어있는 부분인 &lt;img 태그>를 가져오자</span>\r\n        <span class=\"token comment\"># rank 값은 'alt' 속성에 담겨있다</span>\r\n        rank <span class=\"token operator\">=</span> tr<span class=\"token punctuation\">.</span>select_one<span class=\"token punctuation\">(</span><span class=\"token string\">'td:nth-child(1) > img'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token string\">'alt'</span><span class=\"token punctuation\">]</span>\r\n        title <span class=\"token operator\">=</span> a_tag<span class=\"token punctuation\">.</span>text\r\n        stars <span class=\"token operator\">=</span> tr<span class=\"token punctuation\">.</span>select_one<span class=\"token punctuation\">(</span><span class=\"token string\">'td.point'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>text\r\n\r\n        item <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token string\">'rank'</span><span class=\"token punctuation\">:</span> rank<span class=\"token punctuation\">,</span>\r\n            <span class=\"token string\">'title'</span><span class=\"token punctuation\">:</span> title<span class=\"token punctuation\">,</span>\r\n            <span class=\"token string\">'stars'</span><span class=\"token punctuation\">:</span> stars\r\n        <span class=\"token punctuation\">}</span>\r\n        db<span class=\"token punctuation\">.</span>movies<span class=\"token punctuation\">.</span>insert_one<span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">)</span></code></pre></div>","frontmatter":{"title":"[Python] 네이버 영화 페이지 크롤링","summary":"pymongo를 이용한 MongoDB 다루기","date":"2021.07.25.","categories":["Database","Python","MongoDB","Sparta"],"thumbnail":{"childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAAKCAYAAABWiWWfAAAACXBIWXMAABcRAAAXEQHKJvM/AAABNElEQVQoz42Ry0sCYRTFrwZBRGTUwsc8MtE0nXGcyUdIvhJ1mNAoChfRomWL/oBo26Zl//AvnMEYmdIWh+/c+x3Od757JWbrhCE1jZgT4naU/1b7vfDlUiCGilg6cefYr+N2wFc0IR4x+2lYGgkvT7ypIWdJxEwjRgqpJAMDS0Wqyq+Gq2aOjpRVzj8dck91Cl4PzW2Rn3YozLpY8wmjl0dKtwPESPuJNybbn+Q5HBQ58Tokhw6VuyG1uUt6VCd73SYzbiCWsn5m/mlriKlx5D2QGtfZaeY46Bjo7gWJyzJ77RJiZv7xzQVqCmKXeP965e3jitLNiP7zPcVZD2fucjrtsuVk129zJV1VI9NX2G0t6izbjVww+CVCG10/s6XQDOYXfEWNaDYmC7AQ6pFN/fVouPcNmVoGhTLEEAUAAAAASUVORK5CYII=","aspectRatio":1.941747572815534,"src":"/static/2a822c9f08b8b04d5922ffd06c91e53f/c019b/python_mongo.png","srcSet":"/static/2a822c9f08b8b04d5922ffd06c91e53f/a9f05/python_mongo.png 200w,\n/static/2a822c9f08b8b04d5922ffd06c91e53f/23840/python_mongo.png 400w,\n/static/2a822c9f08b8b04d5922ffd06c91e53f/c019b/python_mongo.png 800w,\n/static/2a822c9f08b8b04d5922ffd06c91e53f/00376/python_mongo.png 1200w,\n/static/2a822c9f08b8b04d5922ffd06c91e53f/03b64/python_mongo.png 1600w,\n/static/2a822c9f08b8b04d5922ffd06c91e53f/7a321/python_mongo.png 1602w","srcWebp":"/static/2a822c9f08b8b04d5922ffd06c91e53f/210fa/python_mongo.webp","srcSetWebp":"/static/2a822c9f08b8b04d5922ffd06c91e53f/8444f/python_mongo.webp 200w,\n/static/2a822c9f08b8b04d5922ffd06c91e53f/42fc5/python_mongo.webp 400w,\n/static/2a822c9f08b8b04d5922ffd06c91e53f/210fa/python_mongo.webp 800w,\n/static/2a822c9f08b8b04d5922ffd06c91e53f/3058d/python_mongo.webp 1200w,\n/static/2a822c9f08b8b04d5922ffd06c91e53f/747be/python_mongo.webp 1600w,\n/static/2a822c9f08b8b04d5922ffd06c91e53f/e0279/python_mongo.webp 1602w","sizes":"(max-width: 800px) 100vw, 800px"}}}}}}]}},"pageContext":{"slug":"/네이버_영화_페이지_크롤링/"}},"staticQueryHashes":[]}